<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Introduction to Modelling | R: an introduction to data management and analysis</title>
  <meta name="description" content="The handbook for the Osa Conservation R and biodiversity analysis course." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Introduction to Modelling | R: an introduction to data management and analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The handbook for the Osa Conservation R and biodiversity analysis course." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Introduction to Modelling | R: an introduction to data management and analysis" />
  
  <meta name="twitter:description" content="The handbook for the Osa Conservation R and biodiversity analysis course." />
  

<meta name="author" content="Chris Beirne" />


<meta name="date" content="2020-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-world-data.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup</a><ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#notation"><i class="fa fa-check"></i><b>2.1</b> Notation</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#download-and-open-r"><i class="fa fa-check"></i><b>2.2</b> Download and open R</a></li>
<li class="chapter" data-level="2.3" data-path="setup.html"><a href="setup.html#download-and-open-r-studio"><i class="fa fa-check"></i><b>2.3</b> Download and open R Studio</a></li>
<li class="chapter" data-level="2.4" data-path="setup.html"><a href="setup.html#setting-up-r-studio-to-be-productive"><i class="fa fa-check"></i><b>2.4</b> Setting up R Studio to be productive</a><ul>
<li class="chapter" data-level="2.4.1" data-path="setup.html"><a href="setup.html#r-projects"><i class="fa fa-check"></i><b>2.4.1</b> R Projects</a></li>
<li class="chapter" data-level="2.4.2" data-path="setup.html"><a href="setup.html#create-a-data-sheet-to-save-your-code"><i class="fa fa-check"></i><b>2.4.2</b> Create a data sheet to save your code</a></li>
<li class="chapter" data-level="2.4.3" data-path="setup.html"><a href="setup.html#name-your-files"><i class="fa fa-check"></i><b>2.4.3</b> Name your files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="setup.html"><a href="setup.html#first-steps"><i class="fa fa-check"></i><b>2.5</b> First Steps</a><ul>
<li class="chapter" data-level="2.5.1" data-path="setup.html"><a href="setup.html#veiwing-data"><i class="fa fa-check"></i><b>2.5.1</b> Veiwing Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="setup.html"><a href="setup.html#data-summaries"><i class="fa fa-check"></i><b>2.5.2</b> Data summaries</a></li>
<li class="chapter" data-level="2.5.3" data-path="setup.html"><a href="setup.html#plot-your-data"><i class="fa fa-check"></i><b>2.5.3</b> Plot your data</a></li>
<li class="chapter" data-level="2.5.4" data-path="setup.html"><a href="setup.html#test-your-hypotheses"><i class="fa fa-check"></i><b>2.5.4</b> Test your hypotheses</a></li>
<li class="chapter" data-level="2.5.5" data-path="setup.html"><a href="setup.html#regression-analysis"><i class="fa fa-check"></i><b>2.5.5</b> Regression analysis</a></li>
<li class="chapter" data-level="2.5.6" data-path="setup.html"><a href="setup.html#congratulations"><i class="fa fa-check"></i><b>2.5.6</b> Congratulations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="r-basics.html"><a href="r-basics.html#quick-glossary"><i class="fa fa-check"></i><b>3.1</b> Quick Glossary</a></li>
<li class="chapter" data-level="3.2" data-path="r-basics.html"><a href="r-basics.html#objects-and-functions"><i class="fa fa-check"></i><b>3.2</b> Objects and functions</a></li>
<li class="chapter" data-level="3.3" data-path="r-basics.html"><a href="r-basics.html#r-as-a-calculator"><i class="fa fa-check"></i><b>3.3</b> R as a calculator</a></li>
<li class="chapter" data-level="3.4" data-path="r-basics.html"><a href="r-basics.html#assigning-single-values-a.k.a.-scalars"><i class="fa fa-check"></i><b>3.4</b> Assigning single values (a.k.a. scalars)</a></li>
<li class="chapter" data-level="3.5" data-path="r-basics.html"><a href="r-basics.html#assigning-multiple-values"><i class="fa fa-check"></i><b>3.5</b> Assigning multiple values</a><ul>
<li class="chapter" data-level="3.5.1" data-path="r-basics.html"><a href="r-basics.html#concatenation-a.k.a.-vectors"><i class="fa fa-check"></i><b>3.5.1</b> Concatenation (a.k.a. vectors)</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-basics.html"><a href="r-basics.html#sequences"><i class="fa fa-check"></i><b>3.5.2</b> Sequences</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-basics.html"><a href="r-basics.html#vector-arithmatic"><i class="fa fa-check"></i><b>3.5.3</b> Vector Arithmatic</a></li>
<li class="chapter" data-level="3.5.4" data-path="r-basics.html"><a href="r-basics.html#vector-summaries"><i class="fa fa-check"></i><b>3.5.4</b> Vector Summaries</a></li>
<li class="chapter" data-level="3.5.5" data-path="r-basics.html"><a href="r-basics.html#ordering-and-manipulating-vectors"><i class="fa fa-check"></i><b>3.5.5</b> Ordering and manipulating vectors</a></li>
<li class="chapter" data-level="3.5.6" data-path="r-basics.html"><a href="r-basics.html#removing-objects-from-the-workspace"><i class="fa fa-check"></i><b>3.5.6</b> Removing objects from the workspace</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-basics.html"><a href="r-basics.html#quitting-r"><i class="fa fa-check"></i><b>3.6</b> Quitting R</a></li>
<li class="chapter" data-level="3.7" data-path="r-basics.html"><a href="r-basics.html#packages"><i class="fa fa-check"></i><b>3.7</b> Packages</a><ul>
<li class="chapter" data-level="3.7.1" data-path="r-basics.html"><a href="r-basics.html#install-your-first-package"><i class="fa fa-check"></i><b>3.7.1</b> Install your first package</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-basics.html"><a href="r-basics.html#loading-a-package"><i class="fa fa-check"></i><b>3.7.2</b> Loading a package</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="r-basics.html"><a href="r-basics.html#getting-help"><i class="fa fa-check"></i><b>3.8</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-coding.html"><a href="advanced-coding.html"><i class="fa fa-check"></i><b>4</b> Advanced coding</a><ul>
<li class="chapter" data-level="4.1" data-path="advanced-coding.html"><a href="advanced-coding.html#classes-of-data"><i class="fa fa-check"></i><b>4.1</b> Classes of data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="advanced-coding.html"><a href="advanced-coding.html#numbers"><i class="fa fa-check"></i><b>4.1.1</b> Numbers</a></li>
<li class="chapter" data-level="4.1.2" data-path="advanced-coding.html"><a href="advanced-coding.html#strings"><i class="fa fa-check"></i><b>4.1.2</b> Strings</a></li>
<li class="chapter" data-level="4.1.3" data-path="advanced-coding.html"><a href="advanced-coding.html#characters"><i class="fa fa-check"></i><b>4.1.3</b> Characters</a></li>
<li class="chapter" data-level="4.1.4" data-path="advanced-coding.html"><a href="advanced-coding.html#factors"><i class="fa fa-check"></i><b>4.1.4</b> Factors</a></li>
<li class="chapter" data-level="4.1.5" data-path="advanced-coding.html"><a href="advanced-coding.html#changing-data-structure"><i class="fa fa-check"></i><b>4.1.5</b> Changing data structure</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="advanced-coding.html"><a href="advanced-coding.html#dataframes"><i class="fa fa-check"></i><b>4.2</b> Dataframes</a><ul>
<li class="chapter" data-level="4.2.1" data-path="advanced-coding.html"><a href="advanced-coding.html#exploring-dataframes"><i class="fa fa-check"></i><b>4.2.1</b> Exploring dataframes</a></li>
<li class="chapter" data-level="4.2.2" data-path="advanced-coding.html"><a href="advanced-coding.html#numerical-summaries"><i class="fa fa-check"></i><b>4.2.2</b> Numerical Summaries</a></li>
<li class="chapter" data-level="4.2.3" data-path="advanced-coding.html"><a href="advanced-coding.html#selecting-entries-in-a-dataframe"><i class="fa fa-check"></i><b>4.2.3</b> Selecting entries in a dataframe</a></li>
<li class="chapter" data-level="4.2.4" data-path="advanced-coding.html"><a href="advanced-coding.html#dplyr-and-data-summaries"><i class="fa fa-check"></i><b>4.2.4</b> dplyr and data summaries</a></li>
<li class="chapter" data-level="4.2.5" data-path="advanced-coding.html"><a href="advanced-coding.html#merging-dataframes"><i class="fa fa-check"></i><b>4.2.5</b> Merging dataframes</a></li>
<li class="chapter" data-level="4.2.6" data-path="advanced-coding.html"><a href="advanced-coding.html#exporting-dataframes"><i class="fa fa-check"></i><b>4.2.6</b> Exporting dataframes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="advanced-coding.html"><a href="advanced-coding.html#plots"><i class="fa fa-check"></i><b>4.3</b> Plots</a><ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-coding.html"><a href="advanced-coding.html#scatter-plots"><i class="fa fa-check"></i><b>4.3.1</b> Scatter plots</a></li>
<li class="chapter" data-level="4.3.2" data-path="advanced-coding.html"><a href="advanced-coding.html#exporting-graphs"><i class="fa fa-check"></i><b>4.3.2</b> Exporting Graphs</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-coding.html"><a href="advanced-coding.html#merging-columns"><i class="fa fa-check"></i><b>4.4</b> Merging columns</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="real-world-data.html"><a href="real-world-data.html"><i class="fa fa-check"></i><b>5</b> Real world data</a><ul>
<li class="chapter" data-level="5.1" data-path="real-world-data.html"><a href="real-world-data.html#data-organisation"><i class="fa fa-check"></i><b>5.1</b> Data organisation</a><ul>
<li class="chapter" data-level="5.1.1" data-path="real-world-data.html"><a href="real-world-data.html#the-10-database-commandments"><i class="fa fa-check"></i><b>5.1.1</b> The 10 database commandments</a></li>
<li class="chapter" data-level="5.1.2" data-path="real-world-data.html"><a href="real-world-data.html#my-database-setup"><i class="fa fa-check"></i><b>5.1.2</b> My database setup</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="real-world-data.html"><a href="real-world-data.html#osa-data"><i class="fa fa-check"></i><b>5.2</b> Osa data</a></li>
<li class="chapter" data-level="5.3" data-path="real-world-data.html"><a href="real-world-data.html#importing-a-dataframe-into-r-from-excel"><i class="fa fa-check"></i><b>5.3</b> Importing a dataframe into R from excel</a></li>
<li class="chapter" data-level="5.4" data-path="real-world-data.html"><a href="real-world-data.html#effort-exploration"><i class="fa fa-check"></i><b>5.4</b> Effort exploration</a><ul>
<li class="chapter" data-level="5.4.1" data-path="real-world-data.html"><a href="real-world-data.html#dealing-with-dates"><i class="fa fa-check"></i><b>5.4.1</b> Dealing with dates</a></li>
<li class="chapter" data-level="5.4.2" data-path="real-world-data.html"><a href="real-world-data.html#remove-cameras-that-did-not-function"><i class="fa fa-check"></i><b>5.4.2</b> Remove cameras that did not function</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="real-world-data.html"><a href="real-world-data.html#covariate-data"><i class="fa fa-check"></i><b>5.5</b> Covariate data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="real-world-data.html"><a href="real-world-data.html#plotting-your-survey-sites---substr"><i class="fa fa-check"></i><b>5.5.1</b> Plotting your survey sites - Substr()</a></li>
<li class="chapter" data-level="5.5.2" data-path="real-world-data.html"><a href="real-world-data.html#explore-your-covariates"><i class="fa fa-check"></i><b>5.5.2</b> Explore your covariates</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="real-world-data.html"><a href="real-world-data.html#camera-trap-data"><i class="fa fa-check"></i><b>5.6</b> Camera trap data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="real-world-data.html"><a href="real-world-data.html#subsetting-you-data-to-only-include-species-of-interest."><i class="fa fa-check"></i><b>5.6.1</b> Subsetting you data to only include species of interest.</a></li>
<li class="chapter" data-level="5.6.2" data-path="real-world-data.html"><a href="real-world-data.html#extracting-time-and-date-information"><i class="fa fa-check"></i><b>5.6.2</b> Extracting time and date information</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="real-world-data.html"><a href="real-world-data.html#building-analysis-dataframes"><i class="fa fa-check"></i><b>5.7</b> Building analysis dataframes</a><ul>
<li class="chapter" data-level="5.7.1" data-path="real-world-data.html"><a href="real-world-data.html#relative-abundance"><i class="fa fa-check"></i><b>5.7.1</b> Relative abundance</a></li>
<li class="chapter" data-level="5.7.2" data-path="real-world-data.html"><a href="real-world-data.html#step-1-summarise"><i class="fa fa-check"></i><b>5.7.2</b> Step 1: Summarise</a></li>
<li class="chapter" data-level="5.7.3" data-path="real-world-data.html"><a href="real-world-data.html#step-2-merge-with-effort"><i class="fa fa-check"></i><b>5.7.3</b> Step 2: Merge with effort</a></li>
<li class="chapter" data-level="5.7.4" data-path="real-world-data.html"><a href="real-world-data.html#step-3-merge-the-covariates"><i class="fa fa-check"></i><b>5.7.4</b> Step 3: Merge the covariates</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="real-world-data.html"><a href="real-world-data.html#real-data-exploration"><i class="fa fa-check"></i><b>5.8</b> Real data exploration</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html"><i class="fa fa-check"></i><b>6</b> Introduction to Modelling</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html#is-canopy-height-related-to-habitat-type-at-osa"><i class="fa fa-check"></i><b>6.1</b> Is canopy height related to habitat type at Osa?</a><ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html#what-is-a-model"><i class="fa fa-check"></i><b>6.1.1</b> What is a model</a></li>
<li class="chapter" data-level="6.1.2" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html#the-p-value"><i class="fa fa-check"></i><b>6.1.2</b> The P-value</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html#are-coatis-more-abundant-in-close-proximity-to-the-ocean"><i class="fa fa-check"></i><b>6.2</b> Are Coatis more abundant in close proximity to the ocean</a><ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-modelling.html"><a href="introduction-to-modelling.html#comparing-multiple-predictors-of-coati-detections"><i class="fa fa-check"></i><b>6.2.1</b> Comparing multiple predictors of Coati detections</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R: an introduction to data management and analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-modelling" class="section level1">
<h1><span class="header-section-number">6</span> Introduction to Modelling</h1>
<p>Make a new R script called - “Introduction to Modelling”, give it a title and import the data we will use.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="co"># Title: Linear modelling in R</span></a>
<a class="sourceLine" id="cb274-2" title="2"></a>
<a class="sourceLine" id="cb274-3" title="3"><span class="co"># Read in the covariates dataframe</span></a>
<a class="sourceLine" id="cb274-4" title="4">covariates &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;ClassData/OsaCTgrid_covariates.csv&quot;</span>, <span class="dt">header =</span>T)</a></code></pre></div>
<div id="is-canopy-height-related-to-habitat-type-at-osa" class="section level2">
<h2><span class="header-section-number">6.1</span> Is canopy height related to habitat type at Osa?</h2>
<p>Subset the ‘covariate’ data to just “primary” and “habitat_type”:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1"><span class="co"># Subset the data to just primary and agricultural_matric habitats</span></a>
<a class="sourceLine" id="cb275-2" title="2">hdat &lt;-<span class="st"> </span>covariates[covariates<span class="op">$</span>habitat_type<span class="op">==</span><span class="st">&quot;primary&quot;</span> <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-3" title="3"><span class="st">                     </span>covariates<span class="op">$</span>habitat_type<span class="op">==</span><span class="st">&quot;agricultural_matrix&quot;</span>, ]</a>
<a class="sourceLine" id="cb275-4" title="4"></a>
<a class="sourceLine" id="cb275-5" title="5"><span class="co"># Reset the factor levels:</span></a>
<a class="sourceLine" id="cb275-6" title="6">hdat<span class="op">$</span>habitat_type &lt;-<span class="st"> </span><span class="kw">factor</span>(hdat<span class="op">$</span>habitat_type)</a></code></pre></div>
<div id="what-is-a-model" class="section level3">
<h3><span class="header-section-number">6.1.1</span> What is a model</h3>
<p>When we are “modelling” we are fitting functions to the data in order to explain them. A good model will always explain more information than a bad model, but will not be so complicated that we cannot interperate it. <em>Remember, we are not trying to recreate reality, we are trying to explain reality.</em></p>
<p>On the left is an example of a null model, canopy height does not vary by habitat type (a single intercept), and on the right is a model where the intercept varies by habitat type (an alternate model - more on that later). We determine how much variation a model explains by measuring the ‘sums of squares’ - the squared distance (dashed lines) from our model (line) to the actual data (points). The more complicated model has a lower sums of squares, so it explains more information!</p>
<p><img src="_main_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
<div id="the-p-value" class="section level3">
<h3><span class="header-section-number">6.1.2</span> The P-value</h3>
<p>The problem with just looking at sums of squares is that the more complicated a model is… the more variation it explains. So instead we sometimes use p-values to compare the two alternative models. P-values measure the probability the difference between the null model and the alternative model came about by chance, but only after paying a penalty for how complex the models are (via degrees of freedom - don’t worry about this right now).</p>
<p>Lets run a linear model and see what we get:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(canopy_height<span class="op">~</span>habitat_type,<span class="dt">data=</span>hdat)</a>
<a class="sourceLine" id="cb276-2" title="2"><span class="kw">summary</span>(mod1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = canopy_height ~ habitat_type, data = hdat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.8738 -2.5147  0.5972  2.1187  7.1542 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            8.350      1.173   7.119 1.84e-07 ***
## habitat_typeprimary    8.740      1.478   5.913 3.59e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.709 on 25 degrees of freedom
## Multiple R-squared:  0.5831, Adjusted R-squared:  0.5664 
## F-statistic: 34.97 on 1 and 25 DF,  p-value: 3.592e-06</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="kw">aov</span>(mod1)</a></code></pre></div>
<pre><code>## Call:
##    aov(formula = mod1)
## 
## Terms:
##                 habitat_type Residuals
## Sum of Squares      480.9726  343.8819
## Deg. of Freedom            1        25
## 
## Residual standard error: 3.70881
## Estimated effects may be unbalanced</code></pre>
<p>If you examine the P-value in the table for the <code>habitat_typeprimary</code> category you will see that it is very small, which suggests that the two habitats do indeed have different canopy heights! Great!</p>
<p>Next we need to check if our models fit the assumptions of a liner model, those assumptions are:</p>
<ul>
<li><p><strong>Residuals are independent of each other</strong> Each sample sould be an independent from all the other samples (the result of one should not influence the result of another).</p></li>
<li><p><strong>The explanatory variable X is measured without error</strong> Your measure of the explanatory variable should be exact, in reality this is very difficult to do!</p></li>
<li><p><strong>The residuals of the model are normal</strong> For any given value of X, the sampled Y values normally distributed errors arround the model fit.</p></li>
<li><p><strong>The resudials have constant variability</strong> The model fits the data equally well across the full span of your explanatory variables (homoscedascity = constand variability; heteroscedacity = varying heteroscedacity).</p></li>
</ul>
<p>The first two are difficult to test, but the secon two can be check through plotting th model object:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># chnage to plot window to allow 4 plots</span></a>
<a class="sourceLine" id="cb280-2" title="2"><span class="kw">plot</span>(mod1)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>Look at the first two plots. The top left plot shows that the model fits each category equally well (the red line is flat), the top right plot shows that the residuals are normal (the points follow the dashed line). The bottom two plots help with outlier identification, don’t worry about these for now!</p>
<p>So our model looks reasonable. Let’s do another example.</p>
</div>
</div>
<div id="are-coatis-more-abundant-in-close-proximity-to-the-ocean" class="section level2">
<h2><span class="header-section-number">6.2</span> Are Coatis more abundant in close proximity to the ocean</h2>
<p>Now lets fit a different model using the capture data from the Osa grid. Coatis are well known to raid turtles nests for food, for this reason we might expect that coatis are more frequently detected close to the ocean. Let’s see if this is the case.</p>
<p>First, let’s import our relative abundance index dataset from earlier ()</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="co"># Read in the dataframe</span></a>
<a class="sourceLine" id="cb281-2" title="2">count.sp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;SpeciesRAIdata.csv&quot;</span>, <span class="dt">header=</span>T)</a>
<a class="sourceLine" id="cb281-3" title="3"></a>
<a class="sourceLine" id="cb281-4" title="4"><span class="co"># Subset the data to just coatis</span></a>
<a class="sourceLine" id="cb281-5" title="5">coati &lt;-<span class="st"> </span>count.sp[count.sp<span class="op">$</span>Code<span class="op">==</span><span class="st">&quot;coati&quot;</span>,]</a></code></pre></div>
<p>First lets plot the data:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb282-2" title="2"><span class="kw">plot</span>(coati<span class="op">$</span>RAI<span class="op">~</span>coati<span class="op">$</span>ocean_dist, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;RAI&quot;</span>,</a>
<a class="sourceLine" id="cb282-3" title="3">     <span class="dt">xlab=</span> <span class="st">&quot;Ocean Distance (m)&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<p>Fit the linear models, m1 = capture rate varies by ocean distance:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>ocean_dist, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb283-2" title="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RAI ~ ocean_dist, data = coati)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.992 -4.431 -2.188  1.745 24.175 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.8985846  2.0908781   5.691 5.32e-07 ***
## ocean_dist  -0.0031008  0.0009889  -3.136  0.00277 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.078 on 54 degrees of freedom
## Multiple R-squared:  0.154,  Adjusted R-squared:  0.1384 
## F-statistic: 9.833 on 1 and 54 DF,  p-value: 0.002773</code></pre>
<p>If we examine the p-value for <code>ocean_dist</code> in the m1 model, you can see it is significant (0.00277), suggesting it performs better than the null model (capture rate does not vary by <code>ocean_dist</code>).</p>
<p>Let’s check how the model fits the data.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb285-2" title="2"><span class="kw">plot</span>(m1)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" width="672" />
The top left plot suggests that the model does not fit very well. It is under estimating coati abundance in close proximity to the ocean, over estimating it at intermediate distances, and underestimating it again at far distances.</p>
<p>The top right plot also suggests that our residuals are not normally distributed.</p>
<p>Let’s plot the model prediction to see if this is the case:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">coef</span>(m1) <span class="co"># Pulls out the intercept and slope parameters for the model. </span></a></code></pre></div>
<pre><code>## (Intercept)  ocean_dist 
## 11.89858459 -0.00310083</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb288-2" title="2"><span class="kw">plot</span>(coati<span class="op">$</span>RAI<span class="op">~</span>coati<span class="op">$</span>ocean_dist, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;RAI&quot;</span>,</a>
<a class="sourceLine" id="cb288-3" title="3">     <span class="dt">xlab=</span> <span class="st">&quot;Ocean Distance (m)&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb288-4" title="4"></a>
<a class="sourceLine" id="cb288-5" title="5"><span class="kw">abline</span>(<span class="kw">coef</span>(m1), <span class="dt">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># plots the line</span></a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
<p>Our fitted model fits the description above - it isnt performing very well across the whole range of ocean distance.</p>
<p>Lets try a quadratic shape for the line:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>ocean_dist <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(ocean_dist<span class="op">^</span><span class="dv">2</span>), <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb289-2" title="2"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = RAI ~ ocean_dist + I(ocean_dist^2), data = coati)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.224 -2.881 -1.331  2.140 24.687 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      2.113e+01  2.932e+00   7.209 2.08e-09 ***
## ocean_dist      -1.588e-02  3.272e-03  -4.853 1.11e-05 ***
## I(ocean_dist^2)  3.325e-06  8.205e-07   4.052 0.000167 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.242 on 53 degrees of freedom
## Multiple R-squared:  0.3542, Adjusted R-squared:  0.3298 
## F-statistic: 14.53 on 2 and 53 DF,  p-value: 9.299e-06</code></pre>
<p>The quadratic term is also significant! Interesting. Lets check the model assumptions.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb291-2" title="2"><span class="kw">plot</span>(m2)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<p>They look better than before, the top left plot looks much more like a “sky at night”.</p>
<p>Now lets plot the model predictions. the <code>abline()</code> command we used earlier can only handle straight lines, so our code will have to be more complex:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb292-2" title="2"><span class="kw">plot</span>(coati<span class="op">$</span>RAI<span class="op">~</span>coati<span class="op">$</span>ocean_dist, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;RAI&quot;</span>, </a>
<a class="sourceLine" id="cb292-3" title="3">     <span class="dt">xlab=</span> <span class="st">&quot;Ocean Distance (m)&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb292-4" title="4"><span class="kw">lines</span>(<span class="kw">predict.lm</span>(m2)[<span class="kw">order</span>(coati<span class="op">$</span>ocean_dist)]<span class="op">~</span><span class="st"> </span>coati<span class="op">$</span>ocean_dist[<span class="kw">order</span>(coati<span class="op">$</span>ocean_dist)],</a>
<a class="sourceLine" id="cb292-5" title="5">      <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-202-1.png" width="672" />
That looks great! But now the question becomes… is it better than model 1? Both have significant variables in, but you can’t compare the p-values. Instead we will use information criterion, or AIC. when doesnt an AIC comparison the <strong>lower</strong> number is always better. The lower the number, the more information a model explains (after paying a cost for how complex it is).</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1"><span class="kw">AIC</span>(m1,m2)</a></code></pre></div>
<pre><code>##    df      AIC
## m1  3 382.0666
## m2  4 368.9519</code></pre>
<p>The m2 model has a lower AIC - by a long way (many people assume AICs&gt;2 to reflect a 95% difference).</p>
<p>Congratulations - you have performed your first round of model selection!</p>
<div id="comparing-multiple-predictors-of-coati-detections" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Comparing multiple predictors of Coati detections</h3>
<p>We have several variables which may influence Coati detects. What if we want to found out this is the most important? Again we can use AIC to perform this. The potential predictors we have identified are: river distance, ocean distance, road distance, trail distance, altitude and canopy cover. First fit every model individually, then use the MuMIn package to compare the results:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">n1 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>river_dist, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-2" title="2">n2 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>ocean_dist, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-3" title="3">n3 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>road_dist, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-4" title="4">n4 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>trail_dist, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-5" title="5">n5 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>altitude, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-6" title="6">n6 &lt;-<span class="st"> </span><span class="kw">lm</span>(RAI<span class="op">~</span>canopy_cover, <span class="dt">data=</span>coati)</a>
<a class="sourceLine" id="cb295-7" title="7"></a>
<a class="sourceLine" id="cb295-8" title="8"><span class="kw">library</span>(MuMIn)</a>
<a class="sourceLine" id="cb295-9" title="9"></a>
<a class="sourceLine" id="cb295-10" title="10"><span class="kw">model.sel</span>(n1,n2,n3,n4,n5,n6)</a></code></pre></div>
<pre><code>## Model selection table 
##     (Int) rvr_dst   ocn_dst  rod_dst   trl_dst      alt  cnp_cvr df   logLik
## n2 11.900         -0.003101                                       3 -188.033
## n6 10.020                                               -0.08841  3 -190.562
## n1  3.773  0.0041                                                 3 -191.085
## n5  7.510                                      -0.01449           3 -191.526
## n3  7.720                   -0.00331                              3 -191.782
## n4  7.002                            -0.007115                    3 -192.015
##     AICc delta weight
## n2 382.5  0.00  0.834
## n6 387.6  5.06  0.066
## n1 388.6  6.10  0.039
## n5 389.5  6.98  0.025
## n3 390.0  7.50  0.020
## n4 390.5  7.96  0.016
## Models ranked by AICc(x)</code></pre>
<p>So the ocean distance variable is the best supported predictor! Phew!</p>
<p><strong><em>Task: Try this process with a different animal. Do you get the same result?</em></strong></p>
<p>That is all for now. For more information check out:</p>
<p><strong>Statistics: an introduction using R - Micheal Crawley</strong></p>
<p><strong>The R Book - Micheal Crawley</strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-world-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
